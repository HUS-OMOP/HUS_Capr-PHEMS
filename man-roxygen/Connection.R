#' @param connection   Either an object of type \code{connectionDetails} as created using the
#'                     \code{\link[DatabaseConnector]{createConnectionDetails}} function in the
#'                     DatabaseConnector package or or object of type \code{connection} as created using the
#'                     \code{\link[DatabaseConnector]{connect}} function in the
#'                     DatabaseConnector package. If  \code{connectionDetails}
#'                     is provided a new connection will be opened at the start
#'                     of the function and closed when the function finishes.
